{"is_source_file": true, "format": "TypeScript", "description": "This file provides API service functions for a food ordering frontend, including fetching categories, items, restaurant profiles, managing menus, and handling orders. It also manages client-side caching, mock data fallback, and inventory utilities.", "external_files": ["@/types", "@/types/restaurantProfile", "@/types/restaurant", "./mockData", "./mockData.inventory", "./ordersApi"], "external_methods": ["fetch", "new URL", "import.meta.env", "JSON.parse", "JSON.stringify", "window.localStorage", "crypto.randomUUID"], "published": ["invalidateCaches", "fetchCategories", "fetchItems", "fetchItemById", "getStock", "setStock", "reserveLocal", "getDisplayStock", "createOrder", "submitOrder", "fetchRestaurantProfile", "fetchRestaurants", "listMenuItems", "createMenuItem", "updateMenuItem", "updateAvailability", "applyClientSide", "attachMenusToRestaurants", "findRestaurantAndItem", "featureFlags"], "classes": [], "methods": [{"name": "isValidBaseUrl", "description": "Validates if a given value is a valid URL string."}, {"name": "getApiBase", "description": "Returns the API base URL from environment variables if valid."}, {"name": "getFlags", "description": "Parses feature flags from environment variables."}, {"name": "shouldUseMock", "description": "Determines whether to use mock data based on environment flags and API base URL."}, {"name": "invalidateCaches", "description": "Clears specific or all client-side caches for data re-fetching."}, {"name": "itemsKey", "description": "Generates a cache key for item queries based on parameters."}, {"name": "restaurantsKey", "description": "Generates a cache key for restaurant queries."}, {"name": "fetchCategories", "description": "Fetches food categories for a restaurant, with caching and fallback to mock data."}, {"name": "fetchItems", "description": "Fetches food items with filters, caching, and fallback to mock data."}, {"name": "fetchItemById", "description": "Fetches a specific food item by ID, with caching and fallback."}, {"name": "mockOrderSuccess", "description": "Simulates a successful order response in mock mode."}, {"name": "getStock", "description": "Gets inventory stock for a specific restaurant and item."}, {"name": "setStock", "description": "Sets inventory stock for a specific restaurant and item."}, {"name": "reserveLocal", "description": "Reserves stock locally in client memory."}, {"name": "getDisplayStock", "description": "Calculates display stock considering real stock and local reservations."}, {"name": "createOrder", "description": "Creates an order, updating inventory in mock mode or via API."}, {"name": "submitOrder", "description": "Submits an order, alias for createOrder."}, {"name": "fetchRestaurantProfile", "description": "Fetches a restaurant profile, with caching."}, {"name": "fetchRestaurants", "description": "Fetches list of restaurants with optional query filters."}, {"name": "applyClientSide", "description": "Applies client-side filtering and sorting to restaurant list."}, {"name": "attachMenusToRestaurants", "description": "Attaches stored menus from localStorage to restaurant objects."}, {"name": "findRestaurantAndItem", "description": "Finds which restaurant contains a specific menu item."}, {"name": "listMenuItems", "description": "Lists menu items for a restaurant."}, {"name": "createMenuItem", "description": "Creates a new menu item for a restaurant."}, {"name": "updateMenuItem", "description": "Updates an existing menu item."}, {"name": "updateAvailability", "description": "Updates availability status of a menu item."}, {"name": "applyDefaultAvailability", "description": "Enriches a menu item with default availability based on inventory."}, {"name": "readCustomerMenu", "description": "Reads customer menu from localStorage or mock data."}, {"name": "writeCustomerMenu", "description": "Writes customer menu to localStorage."}, {"name": "applyClientSide", "description": "Filters and sorts restaurant list based on query."}, {"name": "findRestaurantAndItem", "description": "Finds restaurant and item IDs for a menu item."}], "search-terms": ["API service", "food ordering", "mock data fallback", "inventory management", "menu editing", "client cache", "restaurant fetch", "menu item CRUD", "order processing"], "state": 2, "file_id": 19, "knowledge_revision": 301, "git_revision": "292976e3356f645df0135b5cbcc936e926ae1106", "revision_history": [{"41": ""}, {"49": "fa51b25a5136c2a213cbe729e4337be0c6b04b4d"}, {"50": "fa51b25a5136c2a213cbe729e4337be0c6b04b4d"}, {"53": "080dcebf5014d88192e81b4b55bca22f8703ca31"}, {"54": "080dcebf5014d88192e81b4b55bca22f8703ca31"}, {"57": "35883df6824081e2e752a88ef30ca7139d55531b"}, {"59": "2779e9974b574824b22ec1ba11b571a788f48888"}, {"60": "2779e9974b574824b22ec1ba11b571a788f48888"}, {"61": "2779e9974b574824b22ec1ba11b571a788f48888"}, {"72": "7d8d49548b0644d9213c7461f95715f9a2629b00"}, {"73": "7d8d49548b0644d9213c7461f95715f9a2629b00"}, {"85": "410e1f03e40348cb83039a8db9b0f1f0046cad67"}, {"109": "6e54681faac87e0a9d70cc3e42fc4f1b384a3811"}, {"110": "6e54681faac87e0a9d70cc3e42fc4f1b384a3811"}, {"111": "6e54681faac87e0a9d70cc3e42fc4f1b384a3811"}, {"115": "e506a7250757c6c020275949ac7a902f4831d2be"}, {"153": "70569db63a9407628ce40da9eb51b9bf47307f2f"}, {"154": "70569db63a9407628ce40da9eb51b9bf47307f2f"}, {"156": "70569db63a9407628ce40da9eb51b9bf47307f2f"}, {"157": "70569db63a9407628ce40da9eb51b9bf47307f2f"}, {"160": "70569db63a9407628ce40da9eb51b9bf47307f2f"}, {"168": "705df92d392b8a455258cec559766c654947ff8b"}, {"171": "705df92d392b8a455258cec559766c654947ff8b"}, {"172": "705df92d392b8a455258cec559766c654947ff8b"}, {"175": "791f9e66f557ef246118dcf8e1a9d6366df44311"}, {"176": "791f9e66f557ef246118dcf8e1a9d6366df44311"}, {"177": "791f9e66f557ef246118dcf8e1a9d6366df44311"}, {"218": "8dc8af5048045f40d11bafb2aacf41198d73dafe"}, {"301": "292976e3356f645df0135b5cbcc936e926ae1106"}], "ctags": [], "filename": "food_ordering_frontend/src/services/api.ts", "format-version": 4, "code-base-name": "https://github.com/kavia-common/easy-food-order-221713-221722.git:kavia-main"}