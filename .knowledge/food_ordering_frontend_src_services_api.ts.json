{"is_source_file": true, "format": "TypeScript", "description": "This file provides service functions for interacting with an API related to food ordering, including fetching categories, items, restaurants, submitting orders, and utility functions for environment configuration and feature flags. It handles both real API calls and mock data fallback mechanisms.", "external_files": ["@/types", "@/services/mockData"], "external_methods": ["import('@/services/mockData')"], "published": ["getApiBase", "fetchCategories", "fetchItems", "fetchItemById", "submitOrder", "featureFlags", "fetchRestaurants"], "classes": [], "methods": [{"name": "function isValidBaseUrl(v: unknown): v is string { isValidBaseUrl", "description": "Validates if a given URL string is a proper base URL, allowing HTTP/HTTPS and relative URLs.", "scope": "", "scopeKind": ""}, {"name": "export function getApiBase(): string | undefined { getApiBase", "description": "Retrieves the API base URL from environment variables if valid.", "scope": "", "scopeKind": ""}, {"name": "function getFlags(): Record<string, boolean> { getFlags", "description": "Parses feature flags from environment variables, accepting CSV or JSON formats.", "scope": "", "scopeKind": ""}, {"name": "function shouldUseMock(): boolean { shouldUseMock", "description": "Decides whether to use mock data based on environment flags and API base URL.", "scope": "", "scopeKind": ""}, {"name": "async function importMock() { importMock", "description": "Dynamically imports the mock data module.", "scope": "", "scopeKind": ""}, {"name": "export async function fetchCategories(restaurantId?: string): Promise<FoodCategory[]> { fetchCategories", "description": "Fetches food categories from API or mock, optionally for a specific restaurant.", "scope": "", "scopeKind": ""}, {"name": "export async function fetchItems(categoryId?: string, search?: string, restaurantId?: string): P/ fetchItems", "description": "Fetches menu items with optional category, search, and restaurant filters.", "scope": "", "scopeKind": ""}, {"name": "export async function fetchItemById(itemId: string, restaurantId?: string): Promise<FoodItem | n/ fetchItemById", "description": "Fetches a specific food item by ID, optionally restaurant scoped.", "scope": "", "scopeKind": ""}, {"name": "export async function submitOrder(payload: OrderPayload): Promise<OrderResponse> { submitOrder", "description": "Submits an order payload to the API or returns a mock success.", "scope": "", "scopeKind": ""}, {"name": "export async function fetchRestaurants(query: RestaurantQuery = {}): Promise<Restaurant[]> { fetchRestaurants", "description": "Retrieves a list of restaurants with optional filtering and sorting.", "scope": "", "scopeKind": ""}], "calls": ["import('@/services/mockData')", "fetch", "new URL()", "JSON.parse", "window.location.origin"], "search-terms": ["API base URL", "mock data", "food categories", "menu items", "submit order", "fetch restaurants", "feature flags", "environment variables"], "state": 2, "file_id": 19, "knowledge_revision": 57, "git_revision": "35883df6824081e2e752a88ef30ca7139d55531b", "revision_history": [{"41": ""}, {"49": "fa51b25a5136c2a213cbe729e4337be0c6b04b4d"}, {"50": "fa51b25a5136c2a213cbe729e4337be0c6b04b4d"}, {"53": "080dcebf5014d88192e81b4b55bca22f8703ca31"}, {"54": "080dcebf5014d88192e81b4b55bca22f8703ca31"}, {"57": "35883df6824081e2e752a88ef30ca7139d55531b"}], "ctags": [{"_type": "tag", "name": "applyClientSide", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^  const applyClientSide = (list: Restaurant[]): Restaurant[] => {$/", "language": "TypeScript", "kind": "constant", "scope": "fetchRestaurants", "scopeKind": "function"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^  const base = getApiBase()$/", "language": "TypeScript", "kind": "constant", "scope": "fetchCategories", "scopeKind": "function"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^  const base = getApiBase()$/", "language": "TypeScript", "kind": "constant", "scope": "fetchItemById", "scopeKind": "function"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^  const base = getApiBase()$/", "language": "TypeScript", "kind": "constant", "scope": "fetchItems", "scopeKind": "function"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^  const base = getApiBase()$/", "language": "TypeScript", "kind": "constant", "scope": "fetchRestaurants", "scopeKind": "function"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^  const base = getApiBase()$/", "language": "TypeScript", "kind": "constant", "scope": "shouldUseMock", "scopeKind": "function"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^  const base = getApiBase()$/", "language": "TypeScript", "kind": "constant", "scope": "submitOrder", "scopeKind": "function"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^  const base = import.meta.env.VITE_API_BASE || import.meta.env.VITE_BACKEND_URL$/", "language": "TypeScript", "kind": "constant", "scope": "getApiBase", "scopeKind": "function"}, {"_type": "tag", "name": "baseUrl", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const baseUrl = restaurantId$/", "language": "TypeScript", "kind": "constant", "scope": "fetchItems", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const data = await importMock()$/", "language": "TypeScript", "kind": "constant", "scope": "fetchCategories", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const data = await importMock()$/", "language": "TypeScript", "kind": "constant", "scope": "fetchItemById", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const data = await importMock()$/", "language": "TypeScript", "kind": "constant", "scope": "fetchItems", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const data = await importMock()$/", "language": "TypeScript", "kind": "constant", "scope": "fetchRestaurants", "scopeKind": "function"}, {"_type": "tag", "name": "featureFlags", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^export const featureFlags = flags$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "fetchCategories", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^export async function fetchCategories(restaurantId?: string): Promise<FoodCategory[]> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "fetchItemById", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^export async function fetchItemById(itemId: string, restaurantId?: string): Promise<FoodItem | n/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "fetchItems", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^export async function fetchItems(categoryId?: string, search?: string, restaurantId?: string): P/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "fetchRestaurants", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^export async function fetchRestaurants(query: RestaurantQuery = {}): Promise<Restaurant[]> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "flags", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^  const forced = typeof flags.enableMockAPI === 'boolean' ? flags.enableMockAPI : undefined$/", "language": "TypeScript", "kind": "constant", "scope": "shouldUseMock", "scopeKind": "function"}, {"_type": "tag", "name": "flags", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^const flags = getFlags()$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "flagsRaw", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^  const flagsRaw = import.meta.env.VITE_FEATURE_FLAGS$/", "language": "TypeScript", "kind": "constant", "scope": "getFlags", "scopeKind": "function"}, {"_type": "tag", "name": "forced", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^  const forced = typeof flags.enableMockAPI === 'boolean' ? flags.enableMockAPI : undefined$/", "language": "TypeScript", "kind": "constant", "scope": "shouldUseMock", "scopeKind": "function"}, {"_type": "tag", "name": "getApiBase", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^export function getApiBase(): string | undefined {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "getFlags", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^function getFlags(): Record<string, boolean> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "if", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    if (!res.ok) throw new Error('Failed to fetch categories')$/", "language": "TypeScript", "kind": "constant", "scope": "fetchCategories", "scopeKind": "function"}, {"_type": "tag", "name": "importMock", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^async function importMock() {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "isValidBaseUrl", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^function isValidBaseUrl(v: unknown): v is string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "k", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^        const [k, v] = kv.split('=')$/", "language": "TypeScript", "kind": "constant", "scope": "getFlags", "scopeKind": "function"}, {"_type": "tag", "name": "obj", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const obj: Record<string, boolean> = {}$/", "language": "TypeScript", "kind": "constant", "scope": "getFlags", "scopeKind": "function"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const res = await fetch(`${String(base).replace(\\/\\\\\\/+$\\/, '')}\\/orders`, {$/", "language": "TypeScript", "kind": "constant", "scope": "submitOrder", "scopeKind": "function"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const res = await fetch(url, { headers: { 'Content-Type': 'application\\/json' } })$/", "language": "TypeScript", "kind": "constant", "scope": "fetchItemById", "scopeKind": "function"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const res = await fetch(url, { headers: { 'Content-Type': 'application\\/json' } })$/", "language": "TypeScript", "kind": "constant", "scope": "fetchItems", "scopeKind": "function"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const res = await fetch(url, { headers: { 'Content-Type': 'application\\/json' } })$/", "language": "TypeScript", "kind": "constant", "scope": "fetchRestaurants", "scopeKind": "function"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const res = await fetch(url, {$/", "language": "TypeScript", "kind": "constant", "scope": "fetchCategories", "scopeKind": "function"}, {"_type": "tag", "name": "serverList", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const serverList: Restaurant[] = await res.json()$/", "language": "TypeScript", "kind": "constant", "scope": "fetchRestaurants", "scopeKind": "function"}, {"_type": "tag", "name": "shouldUseMock", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^function shouldUseMock(): boolean {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "submitOrder", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^export async function submitOrder(payload: OrderPayload): Promise<OrderResponse> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const url = new URL(`${String(base).replace(\\/\\\\\\/+$\\/, '')}\\/restaurants`, window.location./", "language": "TypeScript", "kind": "constant", "scope": "fetchRestaurants", "scopeKind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const url = new URL(baseUrl, window.location.origin)$/", "language": "TypeScript", "kind": "constant", "scope": "fetchItems", "scopeKind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const url = restaurantId$/", "language": "TypeScript", "kind": "constant", "scope": "fetchCategories", "scopeKind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^    const url = restaurantId$/", "language": "TypeScript", "kind": "constant", "scope": "fetchItemById", "scopeKind": "function"}, {"_type": "tag", "name": "v", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/api.ts", "pattern": "/^        const [k, v] = kv.split('=')$/", "language": "TypeScript", "kind": "constant", "scope": "getFlags", "scopeKind": "function"}], "hash": "153486df022711f7c8d4208c2fc7d405", "format-version": 4, "code-base-name": "food_ordering_frontend", "filename": "food_ordering_frontend/src/services/api.ts"}