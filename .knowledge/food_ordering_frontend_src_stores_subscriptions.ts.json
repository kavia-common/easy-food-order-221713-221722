{"is_source_file": true, "format": "TypeScript", "description": "This file defines a Vue Pinia store for managing user subscriptions, including state management, actions such as load, subscribe, cancel, refresh perks, and local storage persistence.", "external_files": ["@/services/subscriptionsApi", "@/types/subscriptions"], "external_methods": ["listPlans", "getCurrentSubscription", "getPerks", "subscribe", "cancelSubscription"], "published": ["useSubscriptionsStore"], "classes": [], "methods": [{"name": "function safeGetItem(key: string): string | null { safeGetItem", "description": "Safely retrieves an item from localStorage, returning null on error or if window is undefined.", "scope": "", "scopeKind": ""}, {"name": "function safeSetItem(key: string, value: string) { safeSetItem", "description": "Safely sets an item in localStorage, ignoring errors or if window is undefined.", "scope": "", "scopeKind": ""}, {"name": "function loadSnapshot(): Partial<State> | null { loadSnapshot", "description": "Loads and parses the stored snapshot from localStorage; returns null if not available or invalid.", "scope": "", "scopeKind": ""}, {"name": "function persistSnapshot(state: State) { persistSnapshot", "description": "Serializes and saves specific parts of the store state into localStorage.", "scope": "", "scopeKind": ""}], "calls": ["listPlans()", "getCurrentSubscription()", "subscribe(planId)", "cancelSubscription()", "getPerks()"], "search-terms": ["pinia store", "subscriptions management", "local storage persistence", "subscribe", "cancel subscription", "load plans", "load status", "perks"], "state": 2, "file_id": 37, "knowledge_revision": 130, "git_revision": "", "revision_history": [{"124": ""}, {"129": ""}, {"130": ""}], "ctags": [{"_type": "tag", "name": "STORAGE_KEY", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^const STORAGE_KEY = 'subs_store_snapshot_v1';$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "State", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^interface State {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "applied", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^      const applied = Math.min(remaining, Math.max(0, Math.floor(amountCents)));$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "err", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^        const err = (e as Error);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "err", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^        const err = e as Error;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "error", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^  error: string | null;$/", "language": "TypeScript", "kind": "property", "scope": "State", "scopeKind": "interface"}, {"_type": "tag", "name": "loadSnapshot", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^function loadSnapshot(): Partial<State> | null {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "loadingPlans", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^  loadingPlans: boolean;$/", "language": "TypeScript", "kind": "property", "scope": "State", "scopeKind": "interface"}, {"_type": "tag", "name": "loadingStatus", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^  loadingStatus: boolean;$/", "language": "TypeScript", "kind": "property", "scope": "State", "scopeKind": "interface"}, {"_type": "tag", "name": "perks", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^        const perks = await getPerks();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "persistSnapshot", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^function persistSnapshot(state: State) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "plan", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^        const plan = this.plans.find(p => p.id === planId);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "plans", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^  plans: SubscriptionPlan[];$/", "language": "TypeScript", "kind": "property", "scope": "State", "scopeKind": "interface"}, {"_type": "tag", "name": "prev", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^      const prev = this.subscription ? { ...this.subscription } : null;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "raw", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^  const raw = safeGetItem(STORAGE_KEY);$/", "language": "TypeScript", "kind": "constant", "scope": "loadSnapshot", "scopeKind": "function"}, {"_type": "tag", "name": "remaining", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^      const remaining = this.subscription.mealPlanCreditsRemaining || 0;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "result", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^        const result = await cancelSubscription();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "result", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^        const result = await subscribe(planId);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "safeGetItem", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^function safeGetItem(key: string): string | null {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "safeSetItem", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^function safeSetItem(key: string, value: string) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "snapshot", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^      const snapshot = loadSnapshot();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "subscription", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^  subscription: UserSubscription | null;$/", "language": "TypeScript", "kind": "property", "scope": "State", "scopeKind": "interface"}, {"_type": "tag", "name": "useSubscriptionsStore", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/subscriptions.ts", "pattern": "/^export const useSubscriptionsStore = defineStore('subscriptions', {$/", "language": "TypeScript", "kind": "constant"}], "hash": "0f85b06116dabec167ab3f3f24f2f204", "format-version": 4, "code-base-name": "food_ordering_frontend", "filename": "food_ordering_frontend/src/stores/subscriptions.ts", "fields": [{"name": "interface State {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "error: string | null;", "scope": "State", "scopeKind": "interface", "description": "unavailable"}, {"name": "loadingPlans: boolean;", "scope": "State", "scopeKind": "interface", "description": "unavailable"}, {"name": "loadingStatus: boolean;", "scope": "State", "scopeKind": "interface", "description": "unavailable"}, {"name": "plans: SubscriptionPlan[];", "scope": "State", "scopeKind": "interface", "description": "unavailable"}, {"name": "subscription: UserSubscription | null;", "scope": "State", "scopeKind": "interface", "description": "unavailable"}]}