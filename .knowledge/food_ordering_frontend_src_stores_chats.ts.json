{"is_source_file": true, "format": "TypeScript", "description": "This is a TypeScript module defining a store for managing chat threads, messages, and related state for a frontend application using Pinia and Vue. It handles fetching threads, opening a thread, sending messages, subscriptions to real-time updates, and state persistence.", "external_files": ["@/types/chat", "@/services/chatApi"], "external_methods": ["listThreads", "getOrCreateThread", "fetchMessages", "sendMessage", "subscribeToThread"], "published": ["useChatsStore"], "classes": [], "methods": [{"name": "loadThreads", "description": "Fetches and sorts chat threads, updating the store state."}, {"name": "openThread", "description": "Creates or retrieves a chat thread, fetches messages, subscribes to updates, and updates state."}, {"name": "async function send(content: string) { send", "description": "Sends a message in the current thread and updates the message list and thread metadata.", "scope": "", "scopeKind": ""}, {"name": "function markRead(threadId: string) { markRead", "description": "Marks a specific thread as read by resetting its unread count.", "scope": "", "scopeKind": ""}, {"name": "function subscribe(threadId: string) { subscribe", "description": "Subscribes to real-time updates for a specific thread and updates state accordingly.", "scope": "", "scopeKind": ""}, {"name": "function selectThread(threadId: string) { selectThread", "description": "Sets the current thread and initiates subscription and read status update.", "scope": "", "scopeKind": ""}, {"name": "function persistDebounced(state: any) { persistDebounced", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["listThreads", "getOrCreateThread", "fetchMessages", "sendMessage", "subscribeToThread"], "search-terms": ["chat thread store", "Pinia chat module", "Vue chat messaging", "localStorage persistence", "subscribeToThread", "messagesByThread", "thread management"], "state": 2, "file_id": 42, "knowledge_revision": 138, "git_revision": "", "ctags": [{"_type": "tag", "name": "PERSIST_KEY", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/chats.ts", "pattern": "/^const PERSIST_KEY = 'chat_store_state_v1';$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "SubscriptionMap", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/chats.ts", "pattern": "/^interface SubscriptionMap {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "handle", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/chats.ts", "pattern": "/^    const handle = subscribeToThread(threadId, (ev) => {$/", "language": "TypeScript", "kind": "constant", "scope": "subscribe", "scopeKind": "function"}, {"_type": "tag", "name": "markRead", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/chats.ts", "pattern": "/^  function markRead(threadId: string) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/chats.ts", "pattern": "/^    const msg = await sendMessage(currentThreadId.value, { content });$/", "language": "TypeScript", "kind": "constant", "scope": "send", "scopeKind": "function"}, {"_type": "tag", "name": "persistDebounced", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/chats.ts", "pattern": "/^function persistDebounced(state: any) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "selectThread", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/chats.ts", "pattern": "/^  function selectThread(threadId: string) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "send", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/chats.ts", "pattern": "/^  async function send(content: string) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "subscribe", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/chats.ts", "pattern": "/^  function subscribe(threadId: string) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "t", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/chats.ts", "pattern": "/^    const t = threads.value.find((x) => x.id === currentThreadId.value);$/", "language": "TypeScript", "kind": "constant", "scope": "send", "scopeKind": "function"}, {"_type": "tag", "name": "t", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/chats.ts", "pattern": "/^    const t = threads.value.find((x) => x.id === threadId);$/", "language": "TypeScript", "kind": "constant", "scope": "markRead", "scopeKind": "function"}, {"_type": "tag", "name": "useChatsStore", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/chats.ts", "pattern": "/^export const useChatsStore = defineStore('chats', () => {$/", "language": "TypeScript", "kind": "constant"}], "hash": "a006ee3d0eada7cc212f0d24cbd90031", "format-version": 4, "code-base-name": "food_ordering_frontend", "filename": "food_ordering_frontend/src/stores/chats.ts", "fields": [{"name": "interface SubscriptionMap {", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"138": ""}]}