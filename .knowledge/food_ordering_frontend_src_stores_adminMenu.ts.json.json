{"is_source_file": true, "format": "TypeScript", "description": "This file defines a Pinia store for managing restaurant menu items in an admin interface. It handles state, getters, and actions including fetching, adding, editing, and toggling availability of menu items, with caching, optimistic updates, and error handling.", "external_files": ["../types/restaurant", "../services/api"], "external_methods": ["listMenuItems", "createMenuItem", "updateMenuItem", "updateAvailability"], "published": ["useAdminMenuStore"], "classes": [], "methods": [{"name": "fetch", "description": "Fetches menu items for a specified restaurant and updates the store state."}, {"name": "addItem", "description": "Adds a new menu item for a specified restaurant with optimistic update and handles API response."}, {"name": "editItem", "description": "Edits an existing menu item with optimistic update, and rolls back on failure."}, {"name": "toggleAvailability", "description": "Toggles the availability status of a menu item with optimistic update and error handling."}], "calls": ["listMenuItems(restaurantId)", "createMenuItem(restaurantId, payload)", "updateMenuItem(restaurantId, itemId, payload)", "updateAvailability(restaurantId, itemId, status)"], "search-terms": ["adminMenu", "Pinia store", "menu items", "restaurantId cache", "optimistic updates", "rollback"], "state": 2, "file_id": 34, "knowledge_revision": 169, "git_revision": "70569db63a9407628ce40da9eb51b9bf47307f2f", "revision_history": [{"113": ""}, {"117": ""}, {"118": ""}, {"169": "70569db63a9407628ce40da9eb51b9bf47307f2f"}], "ctags": [{"_type": "tag", "name": "after", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const after = [...this.itemsByRestaurant[restaurantId]]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "afterIdx", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const afterIdx = after.findIndex((i) => i.id === itemId)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "afterIdx", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const afterIdx = afterList.findIndex((i) => i.id === itemId)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "afterList", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const afterList = [...this.itemsByRestaurant[restaurantId]]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "availability", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const optimistic: Item = { ...before, availability: status }$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "before", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const before = prev[idx]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "created", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const created = await createMenuItem(restaurantId, payload)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const before = prev[idx]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const idx = prev.findIndex((i) => i.id === itemId)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const items = await listMenuItems(restaurantId)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        let msg = 'Failed to load menu'$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "next", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const next = [...prev]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "optimistic", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const optimistic: Item = { ...before, ...payload }$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "optimistic", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const optimistic: Item = { ...before, availability: status }$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "optimistic", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const optimistic: Item = { id: tempId, ...payload }$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "prev", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const prev = this.itemsByRestaurant[restaurantId] || []$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "restaurantId", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const after = [...this.itemsByRestaurant[restaurantId]]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "restaurantId", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const afterList = [...this.itemsByRestaurant[restaurantId]]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "restaurantId", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const prev = this.itemsByRestaurant[restaurantId] || []$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "rollback", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const rollback = [...prev]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "tempId", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const tempId = `temp-${Date.now()}`$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const updated = await updateAvailability(restaurantId, itemId, status)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const updated = await updateMenuItem(restaurantId, itemId, payload)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "useAdminMenuStore", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^export const useAdminMenuStore = defineStore('adminMenu', {$/", "language": "TypeScript", "kind": "constant"}], "hash": "78f55cc0cceee6ac98a03ac60b3fbcbb", "format-version": 4, "code-base-name": "food_ordering_frontend", "filename": "food_ordering_frontend/src/stores/adminMenu.ts", "fields": [{"name": "let msg = 'Failed to load menu'", "scope": "", "scopeKind": "", "description": "unavailable"}]}