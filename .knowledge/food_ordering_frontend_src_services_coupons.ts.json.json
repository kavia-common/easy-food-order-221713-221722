{"is_source_file": true, "format": "TypeScript", "description": "This file defines types, validation logic, and helper functions related to coupons for a food ordering application. It includes coupon types, validation routines, expiration checks, and mock data for testing.", "external_files": ["./pricing"], "external_methods": ["safeRound2"], "published": ["isExpired", "validateCoupon", "getMockCoupons", "normalizeCoupon", "couponMeetsSubtotal", "CouponBase", "PercentCoupon", "FixedCoupon", "Coupon", "CouponValidation"], "classes": [], "methods": [{"name": "export function isExpired(expiresAt?: string): boolean { isExpired", "description": "Checks if a coupon's expiration date has passed.", "scope": "", "scopeKind": ""}, {"name": "export async function validateCoupon(code: string): Promise<CouponValidation> { validateCoupon", "description": "Validates a coupon code against mock data or backend, returning validation result.", "scope": "", "scopeKind": ""}, {"name": "getMockCoupons", "description": "Provides a list of mock coupons for testing purposes."}, {"name": "normalizeCoupon", "description": "Ensures coupon values are within valid ranges and correctly formatted."}, {"name": "couponMeetsSubtotal", "description": "Determines if a given subtotal satisfies the minimum subtotal requirement for a coupon."}], "calls": ["new Date()", "Date.now()", "fetch()", "normalizeCoupon()", "getMockCoupons()"], "search-terms": ["coupons", "CouponValidation", "validateCoupon", "coupon", "expiresAt", "mockCoupons", "PercentCoupon", "FixedCoupon"], "state": 2, "file_id": 54, "knowledge_revision": 235, "git_revision": "", "ctags": [{"_type": "tag", "name": "Coupon", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^export type Coupon = PercentCoupon | FixedCoupon$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "CouponBase", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^export type CouponBase = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "CouponValidation", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^export type CouponValidation =$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "FixedCoupon", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^export type FixedCoupon = CouponBase & { type: 'fixed'; value: number } \\/\\/ fixed currency off$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "PercentCoupon", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^export type PercentCoupon = CouponBase & { type: 'percent'; value: number } \\/\\/ 0..100$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^  const base = import.meta.env.VITE_API_BASE as string | undefined$/", "language": "TypeScript", "kind": "constant", "scope": "validateCoupon", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^        const data = (await res.json()) as Coupon$/", "language": "TypeScript", "kind": "constant", "scope": "validateCoupon", "scopeKind": "function"}, {"_type": "tag", "name": "exp", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^  const exp = new Date(expiresAt).getTime()$/", "language": "TypeScript", "kind": "constant", "scope": "isExpired", "scopeKind": "function"}, {"_type": "tag", "name": "found", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^  const found = mock.find(c => c.code.toUpperCase() === trimmed)$/", "language": "TypeScript", "kind": "constant", "scope": "validateCoupon", "scopeKind": "function"}, {"_type": "tag", "name": "if", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^      if (res.ok) {$/", "language": "TypeScript", "kind": "constant", "scope": "validateCoupon", "scopeKind": "function"}, {"_type": "tag", "name": "isExpired", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^export function isExpired(expiresAt?: string): boolean {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "mock", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^  const mock = getMockCoupons()$/", "language": "TypeScript", "kind": "constant", "scope": "validateCoupon", "scopeKind": "function"}, {"_type": "tag", "name": "normalized", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^  const normalized = normalizeCoupon(found)$/", "language": "TypeScript", "kind": "constant", "scope": "validateCoupon", "scopeKind": "function"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^      const res = await fetch(`${base.replace(\\/\\\\\\/+$\\/, '')}\\/coupons\\/validate?code=${encodeU/", "language": "TypeScript", "kind": "constant", "scope": "validateCoupon", "scopeKind": "function"}, {"_type": "tag", "name": "trimmed", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^  const trimmed = (code || '').trim().toUpperCase()$/", "language": "TypeScript", "kind": "constant", "scope": "validateCoupon", "scopeKind": "function"}, {"_type": "tag", "name": "validateCoupon", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/coupons.ts", "pattern": "/^export async function validateCoupon(code: string): Promise<CouponValidation> {$/", "language": "TypeScript", "kind": "function"}], "hash": "6a879537463e5d5168249748f503e946", "format-version": 4, "code-base-name": "food_ordering_frontend", "filename": "food_ordering_frontend/src/services/coupons.ts", "revision_history": [{"235": ""}]}