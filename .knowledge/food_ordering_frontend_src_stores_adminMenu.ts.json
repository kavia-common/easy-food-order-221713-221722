{"is_source_file": true, "format": "TypeScript", "description": "This file defines a Pinia store for managing restaurant menu items within an admin panel. It includes state management, getters for accessing data, and actions for fetching, adding, editing, and toggling the availability of menu items, with optimistic UI updates and error handling.", "external_files": ["../types/restaurant", "../services/api"], "external_methods": ["listMenuItems", "createMenuItem", "updateMenuItem", "updateAvailability"], "published": ["useAdminMenuStore"], "classes": [], "methods": [{"name": "fetch", "description": "Fetches menu items for a specified restaurant ID and updates the store's state, handling loading status and errors."}, {"name": "addItem", "description": "Adds a new menu item to a restaurant, optimistically updating the UI and rolling back on failure."}, {"name": "editItem", "description": "Edits an existing menu item, applying optimistic updates and undoing them if the update fails."}, {"name": "toggleAvailability", "description": "Toggles the availability status of a menu item, with optimistic updates and rollback on error."}], "calls": ["listMenuItems", "createMenuItem", "updateMenuItem", "updateAvailability"], "search-terms": ["Pinia store", "admin menu management", "menu items cache", "optimistic updates", "rollback", "restaurantId"], "state": 2, "file_id": 34, "knowledge_revision": 118, "git_revision": "", "revision_history": [{"113": ""}, {"117": ""}, {"118": ""}], "ctags": [{"_type": "tag", "name": "after", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const after = [...this.itemsByRestaurant[restaurantId]]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "afterIdx", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const afterIdx = after.findIndex(i => i.id === itemId)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "afterIdx", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const afterIdx = afterList.findIndex(i => i.id === itemId)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "afterList", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const afterList = [...this.itemsByRestaurant[restaurantId]]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "availability", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const optimistic: Item = { ...before, availability: status }$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "before", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const before = prev[idx]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "created", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const created = await createMenuItem(restaurantId, payload)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const before = prev[idx]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const idx = prev.findIndex(i => i.id === itemId)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const items = await listMenuItems(restaurantId)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "m", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^          const m = (e as Record<string, unknown>).message$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        let msg = 'Failed to load menu'$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "next", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const next = [...prev]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "optimistic", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const optimistic: Item = { ...before, ...payload }$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "optimistic", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const optimistic: Item = { ...before, availability: status }$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "optimistic", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const optimistic: Item = { id: tempId, ...payload }$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "prev", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const prev = this.itemsByRestaurant[restaurantId] || []$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "restaurantId", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const after = [...this.itemsByRestaurant[restaurantId]]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "restaurantId", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const afterList = [...this.itemsByRestaurant[restaurantId]]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "restaurantId", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const prev = this.itemsByRestaurant[restaurantId] || []$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "rollback", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const rollback = [...prev]$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "tempId", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^      const tempId = `temp-${Date.now()}`$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const updated = await updateAvailability(restaurantId, itemId, status)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^        const updated = await updateMenuItem(restaurantId, itemId, payload)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "useAdminMenuStore", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/adminMenu.ts", "pattern": "/^export const useAdminMenuStore = defineStore('adminMenu', {$/", "language": "TypeScript", "kind": "constant"}], "hash": "222addfdbe12fd8b8c56cca35e05cdfa", "format-version": 4, "code-base-name": "food_ordering_frontend", "filename": "food_ordering_frontend/src/stores/adminMenu.ts", "fields": [{"name": "let msg = 'Failed to load menu'", "scope": "", "scopeKind": "", "description": "unavailable"}]}