{"is_source_file": true, "format": "TypeScript", "description": "This file defines a Pinia store for managing a shopping cart in a Vue.js frontend. It includes state for cart items, tax rate, and coupons, as well as functions to manipulate the cart such as add, update, remove items, apply coupons, and persist state to local storage.", "external_files": ["@/types", "@/utils/coupons"], "external_methods": ["findCouponByCode", "validateCoupon", "calcDiscount"], "published": ["useCartStore"], "classes": [], "methods": [{"name": "function addItem(item: FoodItem, qty = 1) { addItem", "description": "Adds an item to the cart or increases its quantity.", "scope": "", "scopeKind": ""}, {"name": "function updateQty(id: string, qty: number) { updateQty", "description": "Updates the quantity of a specific cart line item.", "scope": "", "scopeKind": ""}, {"name": "removeItem", "description": "Removes an item from the cart."}, {"name": "clear", "description": "Clears all items and applied coupons from the cart."}, {"name": "applyCoupon", "description": "Applies a coupon code after validating it against current cart subtotal."}, {"name": "removeCoupon", "description": "Removes any applied coupon from the cart."}, {"name": "persist", "description": "Persists the current cart state to local storage."}, {"name": "function canUseStorage(): boolean { canUseStorage", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function loadPersisted(): State | null { loadPersisted", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["loadPersisted", "canUseStorage", "window.localStorage.getItem", "window.localStorage.setItem", "findCouponByCode", "validateCoupon", "calcDiscount"], "search-terms": ["Pinia store", "cart management", "Vue.js shopping cart", "localStorage persistence", "apply coupon", "cart lines"], "state": 2, "file_id": 22, "knowledge_revision": 70, "git_revision": "639d0e7d3948f2c942493fe6359c8247bac0bdb5", "revision_history": [{"47": ""}, {"66": "fa51b25a5136c2a213cbe729e4337be0c6b04b4d"}, {"70": "639d0e7d3948f2c942493fe6359c8247bac0bdb5"}], "ctags": [{"_type": "tag", "name": "STORAGE_KEY", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^const STORAGE_KEY = 'cart_state_v2'$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "State", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^type State = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "addItem", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^  function addItem(item: FoodItem, qty = 1) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "c", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^    const c = findCouponByCode(code)$/", "language": "TypeScript", "kind": "constant", "scope": "updateQty", "scopeKind": "function"}, {"_type": "tag", "name": "canUseStorage", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^function canUseStorage(): boolean {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "discount", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^  const discount = computed(() => {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "err", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^    const err = validateCoupon(c, subtotal.value)$/", "language": "TypeScript", "kind": "constant", "scope": "updateQty", "scopeKind": "function"}, {"_type": "tag", "name": "err", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^    const err = validateCoupon(c, subtotal.value)$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "existing", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^    const existing = lines.value.find((l) => l.id === item.id)$/", "language": "TypeScript", "kind": "constant", "scope": "addItem", "scopeKind": "function"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^    const idx = lines.value.findIndex((l) => l.id === id)$/", "language": "TypeScript", "kind": "constant", "scope": "updateQty", "scopeKind": "function"}, {"_type": "tag", "name": "loadPersisted", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^function loadPersisted(): State | null {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "raw", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^    const raw = window.localStorage.getItem(STORAGE_KEY)$/", "language": "TypeScript", "kind": "constant", "scope": "loadPersisted", "scopeKind": "function"}, {"_type": "tag", "name": "tax", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^  const tax = computed(() => clampCurrency(taxableAmount.value * taxRate.value))$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "taxableAmount", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^  const taxableAmount = computed(() => Math.max(0, subtotal.value - discount.value))$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "total", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^  const total = computed(() => clampCurrency(taxableAmount.value + tax.value))$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "totals", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^  const totals = computed<CartTotals>(() => ({$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "updateQty", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^  function updateQty(id: string, qty: number) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "useCartStore", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/stores/cart.ts", "pattern": "/^export const useCartStore = defineStore('cart', () => {$/", "language": "TypeScript", "kind": "constant"}], "hash": "ef639f41b8f01f568cd2e52c859a2a5a", "format-version": 4, "code-base-name": "food_ordering_frontend", "filename": "food_ordering_frontend/src/stores/cart.ts"}