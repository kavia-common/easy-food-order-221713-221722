{"is_source_file": true, "format": "TypeScript", "description": "This file provides a set of functions and type definitions for handling various payment methods (UPI, Card, COD) within a frontend application. It includes payment method availability checks, session initialization, payment start functions, and utility functions for tokenizing card details and generating UPI QR data.", "external_files": ["uuid"], "external_methods": ["uuidv4"], "published": ["getAvailableMethods", "initPayment", "startUPIPayment", "startCardPayment", "selectCOD", "tokenizeCard", "buildUPIQRCodeData", "getUPIDefaults"], "classes": [], "methods": [{"name": "export function getAvailableMethods() { getAvailableMethods", "description": "Returns flags indicating which payment methods are available based on environment configuration.", "scope": "", "scopeKind": ""}, {"name": "export async function initPayment(input: InitSessionInput): Promise<InitSessionResult> { initPayment", "description": "Initializes a mock payment session for an order draft, generating session and order IDs.", "scope": "", "scopeKind": ""}, {"name": "export async function startUPIPayment(input: StartUPIInput): Promise<PaymentResult & { deeplink:/ startUPIPayment", "description": "Starts a mock UPI payment and returns a deeplink for payment intent, with a pending status.", "scope": "", "scopeKind": ""}, {"name": "export async function startCardPayment(input: StartCardInput): Promise<PaymentResult> { startCardPayment", "description": "Attempts to start a mock card payment using a client-side tokenized card, with possible failure states.", "scope": "", "scopeKind": ""}, {"name": "export async function selectCOD(orderId: string): Promise<PaymentResult> { selectCOD", "description": "Selects Cash on Delivery payment method, always succeeding in this mock implementation.", "scope": "", "scopeKind": ""}, {"name": "export function tokenizeCard(card: { cardNumber: string; expMonth: string; expYear: string; cvv:/ tokenizeCard", "description": "Mock client-side tokenization of card details, returning a token string.", "scope": "", "scopeKind": ""}, {"name": "export function buildUPIQRCodeData(link: string): string { buildUPIQRCodeData", "description": "Generates QR code data content from a UPI link, here simply returning the link itself.", "scope": "", "scopeKind": ""}, {"name": "export function getUPIDefaults() { getUPIDefaults", "description": "Provides default VPA and merchant name for UI purposes.", "scope": "", "scopeKind": ""}, {"name": "function buildUPILink({ amount, orderId, vpa, merchantName }: { amount: number; orderId: string;/ buildUPILink", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function readEnv(): EnvConfig { readEnv", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["uuidv4", "readEnv"], "search-terms": ["payments", "UPI", "Card", "COD", "tokenization", "payment session", "deeplink", "QR code"], "state": 2, "file_id": 56, "knowledge_revision": 250, "git_revision": "", "ctags": [{"_type": "tag", "name": "EnvConfig", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^type EnvConfig = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "InitSessionInput", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^type InitSessionInput = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "InitSessionResult", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^type InitSessionResult = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "PaymentFailure", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^export type PaymentFailure = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "PaymentResult", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^export type PaymentResult = PaymentSuccess | PaymentFailure$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "PaymentSuccess", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^export type PaymentSuccess = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "StartCardInput", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^export type StartCardInput = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "StartUPIInput", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^export type StartUPIInput = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "UPISupportedProvider", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^export type UPISupportedProvider = 'googlepay' | 'phonepe' | 'paytm' | 'bhim'$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "am", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const am = encodeURIComponent((amount \\/ 100).toFixed(2))$/", "language": "TypeScript", "kind": "constant", "scope": "buildUPILink", "scopeKind": "function"}, {"_type": "tag", "name": "buildUPILink", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^function buildUPILink({ amount, orderId, vpa, merchantName }: { amount: number; orderId: string;/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "buildUPIQRCodeData", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^export function buildUPIQRCodeData(link: string): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "cfg", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const cfg = readEnv()$/", "language": "TypeScript", "kind": "constant", "scope": "buildUPILink", "scopeKind": "function"}, {"_type": "tag", "name": "cfg", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const cfg = readEnv()$/", "language": "TypeScript", "kind": "constant", "scope": "getAvailableMethods", "scopeKind": "function"}, {"_type": "tag", "name": "cfg", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const cfg = readEnv()$/", "language": "TypeScript", "kind": "constant", "scope": "getUPIDefaults", "scopeKind": "function"}, {"_type": "tag", "name": "cvvOk", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^    const cvvOk = \\/^[0-9]{3,4}$\\/.test(card.cvv || '')$/", "language": "TypeScript", "kind": "constant", "scope": "tokenizeCard", "scopeKind": "function"}, {"_type": "tag", "name": "digits", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^    const digits = String(card.cardNumber || '').replace(\\/\\\\s+\\/g, '')$/", "language": "TypeScript", "kind": "constant", "scope": "tokenizeCard", "scopeKind": "function"}, {"_type": "tag", "name": "enableCOD", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const enableCOD = env.VITE_ENABLE_COD !== 'false'$/", "language": "TypeScript", "kind": "constant", "scope": "readEnv", "scopeKind": "function"}, {"_type": "tag", "name": "enableCard", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const enableCard = env.VITE_ENABLE_CARD !== 'false'$/", "language": "TypeScript", "kind": "constant", "scope": "readEnv", "scopeKind": "function"}, {"_type": "tag", "name": "enableUPI", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const enableUPI = env.VITE_ENABLE_UPI !== 'false'$/", "language": "TypeScript", "kind": "constant", "scope": "readEnv", "scopeKind": "function"}, {"_type": "tag", "name": "env", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const env: any = (import.meta as any).env || {}$/", "language": "TypeScript", "kind": "constant", "scope": "readEnv", "scopeKind": "function"}, {"_type": "tag", "name": "expM", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^    const expM = Number(card.expMonth)$/", "language": "TypeScript", "kind": "constant", "scope": "tokenizeCard", "scopeKind": "function"}, {"_type": "tag", "name": "expY", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^    const expY = Number(card.expYear)$/", "language": "TypeScript", "kind": "constant", "scope": "tokenizeCard", "scopeKind": "function"}, {"_type": "tag", "name": "fail", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const fail = Math.random() < 0.05$/", "language": "TypeScript", "kind": "constant", "scope": "startCardPayment", "scopeKind": "function"}, {"_type": "tag", "name": "getAvailableMethods", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^export function getAvailableMethods() {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "getUPIDefaults", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^export function getUPIDefaults() {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "initPayment", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^export async function initPayment(input: InitSessionInput): Promise<InitSessionResult> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "isDev", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const isDev = String(env.VITE_NODE_ENV || env.NODE_ENV || 'development') !== 'production'$/", "language": "TypeScript", "kind": "constant", "scope": "readEnv", "scopeKind": "function"}, {"_type": "tag", "name": "link", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const link = buildUPILink({$/", "language": "TypeScript", "kind": "constant", "scope": "startUPIPayment", "scopeKind": "function"}, {"_type": "tag", "name": "orderId", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const orderId = input.orderDraft.orderId || uuidv4()$/", "language": "TypeScript", "kind": "constant", "scope": "initPayment", "scopeKind": "function"}, {"_type": "tag", "name": "pa", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const pa = encodeURIComponent(vpa || cfg.defaultVpa)$/", "language": "TypeScript", "kind": "constant", "scope": "buildUPILink", "scopeKind": "function"}, {"_type": "tag", "name": "pn", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const pn = encodeURIComponent(merchantName || cfg.merchantName)$/", "language": "TypeScript", "kind": "constant", "scope": "buildUPILink", "scopeKind": "function"}, {"_type": "tag", "name": "readEnv", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^function readEnv(): EnvConfig {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "selectCOD", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^export async function selectCOD(orderId: string): Promise<PaymentResult> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "startCardPayment", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^export async function startCardPayment(input: StartCardInput): Promise<PaymentResult> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "startUPIPayment", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^export async function startUPIPayment(input: StartUPIInput): Promise<PaymentResult & { deeplink:/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "tn", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const tn = encodeURIComponent(`Order ${orderId}`)$/", "language": "TypeScript", "kind": "constant", "scope": "buildUPILink", "scopeKind": "function"}, {"_type": "tag", "name": "tokenizeCard", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^export function tokenizeCard(card: { cardNumber: string; expMonth: string; expYear: string; cvv:/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "tr", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/payments.ts", "pattern": "/^  const tr = encodeURIComponent(uuidv4())$/", "language": "TypeScript", "kind": "constant", "scope": "buildUPILink", "scopeKind": "function"}], "hash": "a7b2a92d30b29ab313312a24f51cd412", "format-version": 4, "code-base-name": "food_ordering_frontend", "filename": "food_ordering_frontend/src/services/payments.ts", "revision_history": [{"250": ""}]}