{"is_source_file": true, "format": "TypeScript", "description": "This file contains utility functions related to pricing calculations for a food ordering system, including computing line subtotal, applying coupons, calculating tax, and aggregating totals.", "external_files": ["@/types", "@/services/coupons"], "external_methods": ["Math.round", "Math.min", "Math.max"], "published": ["safeRound2", "lineSubtotal", "couponDiscount", "computeTax", "computeTotals"], "classes": [], "methods": [{"name": "export function safeRound2(n: number): number { safeRound2", "description": "Rounds a number to two decimal places, avoiding negative zero.", "scope": "", "scopeKind": ""}, {"name": "export function lineSubtotal(lines: CartLine[]): number { lineSubtotal", "description": "Calculates the subtotal for a list of cart lines by multiplying each line's price by its quantity and summing the results.", "scope": "", "scopeKind": ""}, {"name": "export function couponDiscount(subtotal: number, coupon?: Coupon | null): number { couponDiscount", "description": "Calculates the discount amount based on the subtotal and an optional coupon, either percent or fixed.", "scope": "", "scopeKind": ""}, {"name": "export function computeTax(taxable: number, taxRate: number): number { computeTax", "description": "Calculates tax on a taxable amount given a tax rate.", "scope": "", "scopeKind": ""}, {"name": "export function computeTotals(input: TotalsInput): CartTotalsResult { computeTotals", "description": "Aggregates the subtotal, discount, tax, delivery fee, and total for a set of cart lines with optional coupon and tax rate.", "scope": "", "scopeKind": ""}], "calls": ["Math.round", "Math.min", "Math.max"], "search-terms": ["pricing utilities", "cart line subtotal", "coupon discount calculation", "tax computation", "order totals"], "state": 2, "file_id": 53, "knowledge_revision": 233, "git_revision": "", "ctags": [{"_type": "tag", "name": "CartTotalsResult", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/pricing.ts", "pattern": "/^export type CartTotalsResult = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "TotalsInput", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/pricing.ts", "pattern": "/^export type TotalsInput = {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "computeTax", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/pricing.ts", "pattern": "/^export function computeTax(taxable: number, taxRate: number): number {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "computeTotals", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/pricing.ts", "pattern": "/^export function computeTotals(input: TotalsInput): CartTotalsResult {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "couponDiscount", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/pricing.ts", "pattern": "/^export function couponDiscount(subtotal: number, coupon?: Coupon | null): number {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "deliveryFee", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/pricing.ts", "pattern": "/^  const deliveryFee = safeRound2(Math.max(0, input.deliveryFee ?? 0))$/", "language": "TypeScript", "kind": "constant", "scope": "computeTotals", "scopeKind": "function"}, {"_type": "tag", "name": "discount", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/pricing.ts", "pattern": "/^  const discount = couponDiscount(subtotal, input.coupon)$/", "language": "TypeScript", "kind": "constant", "scope": "computeTotals", "scopeKind": "function"}, {"_type": "tag", "name": "lineSubtotal", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/pricing.ts", "pattern": "/^export function lineSubtotal(lines: CartLine[]): number {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "r", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/pricing.ts", "pattern": "/^  const r = Math.round(n * 100) \\/ 100$/", "language": "TypeScript", "kind": "constant", "scope": "safeRound2", "scopeKind": "function"}, {"_type": "tag", "name": "safeRound2", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/pricing.ts", "pattern": "/^export function safeRound2(n: number): number {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "subtotal", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/pricing.ts", "pattern": "/^  const subtotal = lineSubtotal(input.lines)$/", "language": "TypeScript", "kind": "constant", "scope": "computeTotals", "scopeKind": "function"}, {"_type": "tag", "name": "tax", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/pricing.ts", "pattern": "/^  const tax = computeTax(taxable, input.taxRate ?? 0)$/", "language": "TypeScript", "kind": "constant", "scope": "computeTotals", "scopeKind": "function"}, {"_type": "tag", "name": "taxable", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/pricing.ts", "pattern": "/^  const taxable = Math.max(0, subtotal - discount)$/", "language": "TypeScript", "kind": "constant", "scope": "computeTotals", "scopeKind": "function"}, {"_type": "tag", "name": "total", "path": "/home/kavia/workspace/code-generation/easy-food-order-221713-221722/food_ordering_frontend/src/services/pricing.ts", "pattern": "/^  const total = safeRound2(taxable + tax + deliveryFee)$/", "language": "TypeScript", "kind": "constant", "scope": "computeTotals", "scopeKind": "function"}], "hash": "c54e293ae13b2a2426272482e24f6003", "format-version": 4, "code-base-name": "food_ordering_frontend", "filename": "food_ordering_frontend/src/services/pricing.ts", "revision_history": [{"233": ""}]}