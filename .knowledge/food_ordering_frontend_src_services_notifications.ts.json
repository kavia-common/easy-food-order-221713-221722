{"is_source_file": true, "format": "TypeScript", "description": "This file implements a notifications service for a web application, handling browser capability checks, permission requests, user preferences, and mock notifications for 'Festival Offers'. It manages feature flags, local storage preferences, service worker registration, and provides an API for other parts of the app to interact with notifications.", "external_files": ["/sw.js"], "external_methods": ["navigator.serviceWorker.register", "navigator.serviceWorker.getRegistration", "reg.pushManager.getSubscription", "reg.pushManager.subscribe"], "published": ["isNotificationsFeatureEnabled", "isPushSupported", "getCapabilityState", "getNotificationPermission", "getFestivalOffersPreference", "setFestivalOffersPreference", "ensureServiceWorkerRegistered", "requestFestivalOffersPermission", "unsubscribeFestivalOffers", "getCapabilityHelpText", "canToggleForState", "isMockMode", "triggerMockFestivalOffer", "getNotificationsUIState"], "classes": [], "methods": [{"name": "parseFeatureFlags", "description": "Parses feature flags from string input, supporting JSON or comma-separated values."}, {"name": "isNotificationsFeatureEnabled", "description": "Checks if notifications feature is enabled based on feature flags or dev mode."}, {"name": "isPushSupported", "description": "Checks if the browser supports notifications, service workers, and push."}, {"name": "getCapabilityState", "description": "Determines the current notification capability state based on environment and permissions."}, {"name": "getNotificationPermission", "description": "Returns current Notification.permission with caching and localStorage update."}, {"name": "getFestivalOffersPreference", "description": "Retrieves user preference for Festival Offers notifications from localStorage."}, {"name": "setFestivalOffersPreference", "description": "Stores user preference for Festival Offers notifications in localStorage."}, {"name": "ensureServiceWorkerRegistered", "description": "Registers the service worker if supported, returns registration or null."}, {"name": "requestFestivalOffersPermission", "description": "Requests notification permission interactively, registers service worker, and updates state."}, {"name": "unsubscribeFestivalOffers", "description": "Unsubscribes from push notifications and clears related localStorage entries."}, {"name": "getCapabilityHelpText", "description": "Provides user-friendly help text based on notification capability state."}, {"name": "canToggleForState", "description": "Determines if notification toggle should be interactive based on state."}, {"name": "isMockMode", "description": "Checks if mock mode is enabled for development/testing purposes."}, {"name": "triggerMockFestivalOffer", "description": "Simulates a festival offer notification for testing in mock mode."}, {"name": "sendSubscriptionToBackendPlaceholder", "description": "Placeholder for backend subscription management, currently logs info."}, {"name": "getNotificationsUIState", "description": "Provides a snapshot of notification UI state for components."}], "calls": ["JSON.parse", "localStorage.setItem", "localStorage.getItem", "localStorage.removeItem", "navigator.serviceWorker.register", "navigator.serviceWorker.getRegistration", "reg.pushManager.getSubscription", "reg.pushManager.subscribe", "Notification.requestPermission"], "search-terms": ["notifications", "push support", "feature flags", "festival offers", "service worker", "notification permission", "mock notifications", "browser capability checks"], "state": 2, "file_id": 51, "knowledge_revision": 322, "git_revision": "086d02c6d78e440d539b28281df0fc0701bd7617", "revision_history": [{"229": ""}, {"322": "086d02c6d78e440d539b28281df0fc0701bd7617"}], "ctags": [], "filename": "food_ordering_frontend/src/services/notifications.ts", "format-version": 4, "code-base-name": "https://github.com/kavia-common/easy-food-order-221713-221722.git:kavia-main"}